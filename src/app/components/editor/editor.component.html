<div class="row no-gutters editor pb-4"
     [hidden]="!loadComplete">

    <!-- Editor -->
    <div class="col pr-md-2 editor-wrapper">
        <app-tiny-editor [(markdownHtml)]="markdownHtml"
                         [height]="compHeight + 27"
                         (loadComplete)="onEditorLoad($event)"></app-tiny-editor>
    </div>

    <!-- Preview -->
    <div class="col pl-md-2 preview-wrapper">
        <div class="card text-center">
            <div class="card-header bg-editor-gray pt-2">

                <ul class="nav nav-tabs card-header-tabs"
                    role="tablist">

                    <li class="nav-item">
                        <a class="nav-link"
                           [ngClass]="{'active': activeTab === 'preview' }"
                           (click)="activeTab='preview'"
                           role="tab">Preview</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                           [ngClass]="{'active': activeTab === 'markdown' }"
                           (click)="activeTab='markdown'"
                           role="tab">Markdown</a>
                    </li>

                </ul>

            </div>
            <div class="card-body p-1"
                 #previewTabBody>
                <!-- Tab panes -->
                <div class="tab-content p-2">

                    <!-- Preview tab -->
                    <div class="tab-pane active show fade text-left"
                         [ngClass]="{'show': activeTab === 'preview' }"
                         role="tabpanel">
                        <div *ngIf="activeTab === 'preview'"
                             class="tab-pane-inner"
                             [style.height.px]="compHeight">
                            <div class="markdown-body text-dark"
                                 [innerHtml]="markdownHtml"></div>
                        </div>
                    </div>

                    <!-- markdown tab -->
                    <div class="tab-pane active fade"
                         [ngClass]="{'show': activeTab === 'markdown' }"
                         role="tabpanel">
                        <div *ngIf="activeTab === 'markdown'"
                             [style.height.px]="compHeight"
                             class="tab-pane-inner">
                            <textarea class="w-100 h-100 border-0 markdown-preview"
                                      [ngModel]="markdownHtml | markdownConvertor"
                                      readonly></textarea>

                        </div>
                    </div>

                </div>
                <!-- tab content -->
            </div>
        </div>
    </div>
    <!-- preview wrapper -->
</div>

<!-- Editor Modals -->
<div class="models-wrap">
    <div id="editor-modal"
         #modal
         class="modal fade p-0">
        <div class="modal-dialog"
             [ngClass]="modals[openModalKey]?.size"
             role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{modals[openModalKey]?.title}}</h5>
                    <button type="button"
                            class="close"
                            (click)="closeModal()">
                  <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body pb-2"
                     [style.height.px]="modalHeight">

                    <!-- Commit to Git modal -->
                    <div *ngIf="openModalKey === 'commitToGit'">
                        <app-commit-to-git [fileContent]="markdownHtml | markdownConvertor"
                                           [repoName]="project?.gitRepo"
                                           (onComplete)="closeModal($event)"></app-commit-to-git>
                    </div>

                    <!-- Save Markdown modal -->
                    <div *ngIf="openModalKey === 'save'">
                        <app-save-markdown [markdown]="markdown"
                                           [project]="project"
                                           (onComplete)="closeModal($event)"></app-save-markdown>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / Editor Modals -->

<!-- footer -->
<nav class="navbar navbar-expand bg-faded border-faded fixed-bottom hvj-footer p-1 px-3">
    <div class="mr-auto form-inline"
         *ngIf="project">
        <a class="btn btn-primary btn-sm ml-2 py-1"
           [routerLink]="['/project', project._id]"> 
           <i class="fa fa-gear fa-lg"></i> 
           <span>{{project.name}}</span>
        </a>
        <span class="ml-2"
              *ngIf="markdown">
            <small><em>Last Edited by <span class="text-dark font-weight-bold">{{markdown.editedBy}}</span> on <span class="text-dark">{{markdown.editedOn | date: 'short'}}</span></em>
        </small>
        </span>
    </div>

    <div class="ml-auto form-inline">
        <button class="btn btn-primary btn-sm ml-2 py-1"
                (click)="save()"> 
                <span>Save</span>
        </button>
        <button class="btn btn-primary btn-sm ml-2 py-1"
                (click)="showCommitToGitModal()">
                <span>Commit to Git</span> <i class="fa fa-github fa-lg ml-2" aria-hidden="true"></i>
        </button>
        <button class="btn btn-primary btn-sm ml-2 py-1"
                (click)="download()">
                <span>Download</span> <i class="fa fa-download fa-lg ml-2" aria-hidden="true"></i>
        </button>
    </div>
</nav>